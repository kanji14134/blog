---
categories:
- R
date: 2017-01-14T19:19:01+09:00
type: "post"
draft: TRUE
tags:
- ecology
- homerange
title: "homerange_1"
author: "kanji14134"
---


<!-- BLOGDOWN-BODY-BEFORE

/BLOGDOWN-BODY-BEFORE -->

<div class="section level3">
<h3>これは下書きです。</h3>
<p>野生動物の研究ではしばしば位置情報を観察、VHF発信機、GPS首輪などから取得してなんかします。 行動圏と言われるものを推定したりです。 今回は最先端?な手法である<a href="http://ecosystems.psu.edu/research/labs/walter-lab/manual/home-range-estimation/4.4-brownian-bridge-movement-models-bbmm">BBMMとdBBMM</a>をやってみます。 もっと広く使われているのはまた今度やります。</p>
<div class="section level4">
<h4>データ</h4>
<p>データはMOVEBANKにおいてある、<a href="https://www.datarepository.movebank.org/handle/10255/move.510">Choi C et al. 2016</a>を使います。 CC0なので安心して使えますね。 utm座標とローカルタイムのオプションつけてDLして置きます。 datに格納して見てみましょう。</p>
<pre class="r"><code>require(readr);require(dplyr);require(magrittr);require(stringr)
dat &lt;- read_csv(&quot;../../static/2017/01/Poultry network China (data from Choi et al. 2016).csv&quot;) %&gt;% 
  set_names(.,names(.) %&gt;% str_replace_all(&quot;-&quot;,&quot;_&quot;)) %&gt;% 
  dplyr::select(sp = individual_taxon_canonical_name,id = individual_local_identifier,timestamp,utm_easting,utm_northing,utm_zone) 
dat %&gt;% 
  glimpse()</code></pre>
<pre><code>## Observations: 1,329
## Variables: 6
## $ sp           &lt;chr&gt; &quot;Anas platyrhynchos&quot;, &quot;Anas platyrhynchos&quot;, &quot;Anas...
## $ id           &lt;int&gt; 4189, 4189, 4189, 4189, 4189, 4189, 4189, 4189, 4...
## $ timestamp    &lt;dttm&gt; 2015-01-09 00:02:10, 2015-01-09 11:59:39, 2015-0...
## $ utm_easting  &lt;dbl&gt; 421316.4, 421453.5, 421465.0, 421495.0, 421425.7,...
## $ utm_northing &lt;dbl&gt; 3173161, 3172491, 3172500, 3172844, 3172473, 3172...
## $ utm_zone     &lt;dbl&gt; 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 5...</code></pre>
<p>Anas platyrhynchosとは<a href="https://ja.wikipedia.org/wiki/%E3%83%9E%E3%82%AC%E3%83%A2">マガモ</a>のようです。データはアヒルかもしれません。 1300レコードほどありますが、何個体かいそうです。確認してみましょう。</p>
<pre class="r"><code>dat %&gt;% distinct(id)</code></pre>
<pre><code>## # A tibble: 39 × 1
##       id
##    &lt;int&gt;
## 1   4189
## 2   4135
## 3   4181
## 4   4152
## 5   4173
## 6   4176
## 7   4159
## 8   4156
## 9   4171
## 10  4182
## # ... with 29 more rows</code></pre>
</div>
<div id="bbmm" class="section level4">
<h4>BBMM</h4>
<p>BBMMは{BBMM}パッケージで提供されており、XYとタイムラグを食わせれば良いみたいです。 {dplyr}にもラグ関数があるのでそれを利用しましょう。 ###これは下書きです。</p>
</div>
</div>


<!-- BLOGDOWN-HEAD




/BLOGDOWN-HEAD -->
