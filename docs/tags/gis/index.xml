<?xml version="1.0" encoding="utf-8" standalone="yes" ?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>Gis on 統計とかのメモ</title>
    <link>/tags/gis/index.xml</link>
    <description>Recent content in Gis on 統計とかのメモ</description>
    <generator>Hugo -- gohugo.io</generator>
    <language>en-us</language>
    <copyright>Except where otherwise noted, content on this site is licensed under a [Creative Commons Attribution 4.0 International license](https://creativecommons.org/licenses/by-sa/4.0/).</copyright>
    <atom:link href="/tags/gis/index.xml" rel="self" type="application/rss+xml" />
    
    <item>
      <title>sf,instead of sp</title>
      <link>/2017/04/sfinstead-of-sp/</link>
      <pubDate>Wed, 19 Apr 2017 20:30:40 +0900</pubDate>
      
      <guid>/2017/04/sfinstead-of-sp/</guid>
      <description>&lt;!-- BLOGDOWN-BODY-BEFORE

/BLOGDOWN-BODY-BEFORE --&gt;

&lt;p&gt;今話題の&lt;strong&gt;sf&lt;/strong&gt;パッケージ、まさか知らない人はいないでしょう&lt;a href=&#34;http://notchained.hatenablog.com/entry/2017/01/06/213333&#34;&gt;??&lt;/a&gt;。&lt;br /&gt;
今回はじめて使いましたので、簡単にメモ。&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;library(dplyr)&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## 
##  次のパッケージを付け加えます: &amp;#39;dplyr&amp;#39;&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;##  以下のオブジェクトは &amp;#39;package:stats&amp;#39; からマスクされています: 
## 
##      filter, lag&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;##  以下のオブジェクトは &amp;#39;package:base&amp;#39; からマスクされています: 
## 
##      intersect, setdiff, setequal, union&lt;/code&gt;&lt;/pre&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;library(sf)&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## Linking to GEOS 3.5.0, GDAL 2.1.1, proj.4 4.9.3&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Shapeファイルからの読み込みの例が多かったので、&lt;br /&gt;
data.frameから作る場合をやってみます。 irisに適当に座標をつけます。&lt;br /&gt;
この場合はst_as_sf()で簡単に作ることができます。 SP*オブジェクトよりもスッキリしてる気がします。&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;iris_sf_wgs&amp;lt;- iris %&amp;gt;% 
  mutate(x = rnorm(dim(iris)[1],140,1),
         y = rnorm(dim(iris)[1],35,1)) %&amp;gt;% 
  st_as_sf(coords = c(&amp;quot;x&amp;quot;,&amp;quot;y&amp;quot;),
           crs = 4326)
iris_sf_wgs %&amp;gt;% 
  head()&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## Simple feature collection with 6 features and 5 fields
## geometry type:  POINT
## dimension:      XY
## bbox:           xmin: 138.7596 ymin: 33.80348 xmax: 141.7678 ymax: 36.31975
## epsg (SRID):    4326
## proj4string:    +proj=longlat +datum=WGS84 +no_defs
##   Sepal.Length Sepal.Width Petal.Length Petal.Width Species
## 1          5.1         3.5          1.4         0.2  setosa
## 2          4.9         3.0          1.4         0.2  setosa
## 3          4.7         3.2          1.3         0.2  setosa
## 4          4.6         3.1          1.5         0.2  setosa
## 5          5.0         3.6          1.4         0.2  setosa
## 6          5.4         3.9          1.7         0.4  setosa
##                         geometry
## 1 POINT(139.365039684377 33.8...
## 2 POINT(140.214536836506 36.3...
## 3 POINT(140.153729658544 34.3...
## 4 POINT(141.767759920242 35.4...
## 5 POINT(138.759600487672 34.5...
## 6 POINT(138.872964867377 34.1...&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;geometryに座標が入りました。postGISみたいなやつですね。 投影変換はst_transformです。crsに直接EPSGコードをぶち込めます。&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;iris_sf_wgs %&amp;gt;% 
  st_transform(crs = 32654) %&amp;gt;% 
  head()&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## Simple feature collection with 6 features and 5 fields
## geometry type:  POINT
## dimension:      XY
## bbox:           xmin: 294476.4 ymin: 3741568 xmax: 569669.5 ymax: 4019700
## epsg (SRID):    32654
## proj4string:    +proj=utm +zone=54 +datum=WGS84 +units=m +no_defs
##   Sepal.Length Sepal.Width Petal.Length Petal.Width Species
## 1          5.1         3.5          1.4         0.2  setosa
## 2          4.9         3.0          1.4         0.2  setosa
## 3          4.7         3.2          1.3         0.2  setosa
## 4          4.6         3.1          1.5         0.2  setosa
## 5          5.0         3.6          1.4         0.2  setosa
## 6          5.4         3.9          1.7         0.4  setosa
##                         geometry
## 1 POINT(348660.262983917 3741...
## 2 POINT(429494.283147815 4019...
## 3 POINT(422202.792112733 3805...
## 4 POINT(569669.470954922 3923...
## 5 POINT(294476.374398475 3827...
## 6 POINT(303986.204951326 3784...&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;plotでの描画はこの通り。&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;plot(iris_sf_wgs %&amp;gt;% select(Species))&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;/2017/04/sfinstead-of-sp/figures/unnamed-chunk-4-1.png&#34; width=&#34;672&#34; /&gt;&lt;/p&gt;
&lt;p&gt;ggplotで扱うにはまだ開発中である&lt;a href=&#34;https://dcl-2017-01.github.io/curriculum/notes/spatial-vis.html&#34;&gt;geom_sf&lt;/a&gt;があります。&lt;/p&gt;
&lt;p&gt;Happy mapping!&lt;/p&gt;


&lt;!-- BLOGDOWN-HEAD




/BLOGDOWN-HEAD --&gt;
</description>
    </item>
    
  </channel>
</rss>
